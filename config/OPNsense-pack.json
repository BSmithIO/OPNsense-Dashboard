{
  "v": "1",
  "id": "6f88399d-9c58-4a70-b7fe-30d4a057132a",
  "rev": 3,
  "name": "OPNsense Dashboard",
  "summary": "This pack includes everything needed to setup Graylog for the dashboard.",
  "description": "",
  "vendor": "bsmithio",
  "url": "https://github.com/bsmithio/OPNsense-Dashboard",
  "parameters": [],
  "entities": [
    {
      "v": "1",
      "type": {
        "name": "input",
        "version": "1"
      },
      "id": "ea0188df-eb94-48be-81c0-7776f995b89b",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Syslog UDP"
        },
        "configuration": {
          "port": {
            "@type": "integer",
            "@value": 1514
          },
          "recv_buffer_size": {
            "@type": "integer",
            "@value": 262144
          },
          "force_rdns": {
            "@type": "boolean",
            "@value": false
          },
          "allow_override_date": {
            "@type": "boolean",
            "@value": true
          },
          "bind_address": {
            "@type": "string",
            "@value": "0.0.0.0"
          },
          "expand_structured_data": {
            "@type": "boolean",
            "@value": false
          },
          "store_full_message": {
            "@type": "boolean",
            "@value": true
          },
          "charset_name": {
            "@type": "string",
            "@value": "UTF-8"
          },
          "number_worker_threads": {
            "@type": "integer",
            "@value": 6
          }
        },
        "static_fields": {},
        "type": {
          "@type": "string",
          "@value": "org.graylog2.inputs.syslog.udp.SyslogUDPInput"
        },
        "global": {
          "@type": "boolean",
          "@value": false
        },
        "extractors": [
          {
            "target_field": {
              "@type": "string",
              "@value": "filterlog_ipv6_icmp"
            },
            "condition_value": {
              "@type": "string",
              "@value": "^(?i).*\\sfilterlog.+\\[.+\\]\\s(.*,(in|out),6,.*,icmp,.*)$"
            },
            "order": {
              "@type": "integer",
              "@value": 5
            },
            "converters": [
              {
                "type": {
                  "@type": "string",
                  "@value": "CSV"
                },
                "configuration": {
                  "column_header": {
                    "@type": "string",
                    "@value": "rule-number,sub-rule-number,anchor,tracker,interface,reason,action,direction,ip-version,class,flowlabel,hoplimit,protocol-name,protocol-id,length,src-ip,dst-ip,datalength"
                  }
                }
              }
            ],
            "configuration": {
              "regex_value": {
                "@type": "string",
                "@value": "^(?i).*\\sfilterlog.+\\[.+\\]\\s(.*)$"
              }
            },
            "source_field": {
              "@type": "string",
              "@value": "full_message"
            },
            "title": {
              "@type": "string",
              "@value": "OPNsense: RFC5424 IPv6 ICMP"
            },
            "type": {
              "@type": "string",
              "@value": "REGEX"
            },
            "cursor_strategy": {
              "@type": "string",
              "@value": "COPY"
            },
            "condition_type": {
              "@type": "string",
              "@value": "REGEX"
            }
          },
          {
            "target_field": {
              "@type": "string",
              "@value": "filterlog_ipv6_tcp"
            },
            "condition_value": {
              "@type": "string",
              "@value": "^(?i).*\\sfilterlog.+\\[.+\\]\\s(.*,(in|out),6,.*,tcp,.*)$"
            },
            "order": {
              "@type": "integer",
              "@value": 1
            },
            "converters": [
              {
                "type": {
                  "@type": "string",
                  "@value": "CSV"
                },
                "configuration": {
                  "column_header": {
                    "@type": "string",
                    "@value": "rule-number,sub-rule-number,anchor,tracker,interface,reason,action,direction,ipversion,class,flowlabel,hoplimit,protocol-name,protocol-id,length,src-ip,dst-ip,src-port,dst-port,datalength,tcp-flags,sequence,ack,window,urg,options,opnsense-rid"
                  },
                  "trim_leading_whitespace": {
                    "@type": "boolean",
                    "@value": true
                  }
                }
              }
            ],
            "configuration": {
              "regex_value": {
                "@type": "string",
                "@value": "^(?i).*\\sfilterlog.+\\[.+\\]\\s(.*)$"
              }
            },
            "source_field": {
              "@type": "string",
              "@value": "full_message"
            },
            "title": {
              "@type": "string",
              "@value": "OPNsense: RFC5424 IPv6 TCP"
            },
            "type": {
              "@type": "string",
              "@value": "REGEX"
            },
            "cursor_strategy": {
              "@type": "string",
              "@value": "COPY"
            },
            "condition_type": {
              "@type": "string",
              "@value": "REGEX"
            }
          },
          {
            "target_field": {
              "@type": "string",
              "@value": "filterlog_ipv4_tcp"
            },
            "condition_value": {
              "@type": "string",
              "@value": "^(?i).*\\sfilterlog.+\\[.+\\]\\s(.*,(in|out),4,.*,tcp,.*)$"
            },
            "order": {
              "@type": "integer",
              "@value": 0
            },
            "converters": [
              {
                "type": {
                  "@type": "string",
                  "@value": "CSV"
                },
                "configuration": {
                  "column_header": {
                    "@type": "string",
                    "@value": "rule-number,sub-rule-number,anchor,tracker,interface,reason,action,direction,ip-version,tos,ecn,ttl,id,offset,ip-flags,protocol-id,protocol-name,length,src-ip,dst-ip,src-port,dst-port,datalength,tcp-flags,sequence,f1,f2,tcp-options,opnsense-rid"
                  },
                  "trim_leading_whitespace": {
                    "@type": "boolean",
                    "@value": true
                  }
                }
              }
            ],
            "configuration": {
              "regex_value": {
                "@type": "string",
                "@value": "^(?i).*\\sfilterlog.+\\[.+\\]\\s(.*)$"
              }
            },
            "source_field": {
              "@type": "string",
              "@value": "full_message"
            },
            "title": {
              "@type": "string",
              "@value": "OPNsense: RFC5424 IPv4 TCP"
            },
            "type": {
              "@type": "string",
              "@value": "REGEX"
            },
            "cursor_strategy": {
              "@type": "string",
              "@value": "COPY"
            },
            "condition_type": {
              "@type": "string",
              "@value": "REGEX"
            }
          },
          {
            "target_field": {
              "@type": "string",
              "@value": "filterlog_ipv4_udp"
            },
            "condition_value": {
              "@type": "string",
              "@value": "^(?i).*\\sfilterlog.+\\[.+\\]\\s(.*,(in|out),4,.*,udp,.*)$"
            },
            "order": {
              "@type": "integer",
              "@value": 2
            },
            "converters": [
              {
                "type": {
                  "@type": "string",
                  "@value": "CSV"
                },
                "configuration": {
                  "column_header": {
                    "@type": "string",
                    "@value": "rule-number,sub-rule-number,anchor,tracker,interface,reason,action,direction,ip-version,tos,ecn,ttl,id,offset,flags,protocol-id,protocol-name,length,src-ip,dst-ip,src-port,dst-port,opnsense-rid"
                  },
                  "trim_leading_whitespace": {
                    "@type": "boolean",
                    "@value": true
                  }
                }
              }
            ],
            "configuration": {
              "regex_value": {
                "@type": "string",
                "@value": "^(?i).*\\sfilterlog.+\\[.+\\]\\s(.*)$"
              }
            },
            "source_field": {
              "@type": "string",
              "@value": "full_message"
            },
            "title": {
              "@type": "string",
              "@value": "OPNsense: RFC5424 IPv4 UDP"
            },
            "type": {
              "@type": "string",
              "@value": "REGEX"
            },
            "cursor_strategy": {
              "@type": "string",
              "@value": "COPY"
            },
            "condition_type": {
              "@type": "string",
              "@value": "REGEX"
            }
          },
          {
            "target_field": {
              "@type": "string",
              "@value": "filterlog_ipv4_icmp"
            },
            "condition_value": {
              "@type": "string",
              "@value": "^(?i).*\\sfilterlog.+\\[.+\\]\\s(.*,(in|out),4,.*,icmp,.*)$"
            },
            "order": {
              "@type": "integer",
              "@value": 4
            },
            "converters": [
              {
                "type": {
                  "@type": "string",
                  "@value": "CSV"
                },
                "configuration": {
                  "column_header": {
                    "@type": "string",
                    "@value": "rule-number,sub-rule-number,anchor,tracker,interface,reason,action,direction,ip-version,tos,ecn,ttl,id,offset,flags,protocol-id,protocol-name,length,src-ip,dst-ip,datalength"
                  }
                }
              }
            ],
            "configuration": {
              "regex_value": {
                "@type": "string",
                "@value": "^(?i).*\\sfilterlog.+\\[.+\\]\\s(.*)$"
              }
            },
            "source_field": {
              "@type": "string",
              "@value": "full_message"
            },
            "title": {
              "@type": "string",
              "@value": "OPNsense: RFC5424 IPv4 ICMP"
            },
            "type": {
              "@type": "string",
              "@value": "REGEX"
            },
            "cursor_strategy": {
              "@type": "string",
              "@value": "COPY"
            },
            "condition_type": {
              "@type": "string",
              "@value": "REGEX"
            }
          },
          {
            "target_field": {
              "@type": "string",
              "@value": "filterlog_ipv6_udp"
            },
            "condition_value": {
              "@type": "string",
              "@value": "^(?i).*\\sfilterlog.+\\[.+\\]\\s(.*,(in|out),6,.*,udp,.*)$"
            },
            "order": {
              "@type": "integer",
              "@value": 3
            },
            "converters": [
              {
                "type": {
                  "@type": "string",
                  "@value": "CSV"
                },
                "configuration": {
                  "column_header": {
                    "@type": "string",
                    "@value": "rule-number,sub-rule-number,anchor,tracker,interface,reason,action,direction,ip-version,class,flowlabel,hoplimit,protocol-name,protocol-id,length,src-ip,dst-ip,src-port,dst-port,opnsense-rid"
                  }
                }
              }
            ],
            "configuration": {
              "regex_value": {
                "@type": "string",
                "@value": "^(?i).*\\sfilterlog.+\\[.+\\]\\s(.*)$"
              }
            },
            "source_field": {
              "@type": "string",
              "@value": "full_message"
            },
            "title": {
              "@type": "string",
              "@value": "OPNsense: RFC5424 IPv6 UDP"
            },
            "type": {
              "@type": "string",
              "@value": "REGEX"
            },
            "cursor_strategy": {
              "@type": "string",
              "@value": "COPY"
            },
            "condition_type": {
              "@type": "string",
              "@value": "REGEX"
            }
          }
        ]
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.1+4337e8c"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_adapter",
        "version": "1"
      },
      "id": "475baaaa-123f-471c-96a0-b405277f6cb5",
      "data": {
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "name": {
          "@type": "string",
          "@value": "geoip"
        },
        "title": {
          "@type": "string",
          "@value": "GeoIP"
        },
        "description": {
          "@type": "string",
          "@value": "Geo IP Lookup Table"
        },
        "configuration": {
          "type": {
            "@type": "string",
            "@value": "maxmind_geoip"
          },
          "path": {
            "@type": "string",
            "@value": "/usr/share/graylog/data/data/GeoLite2-Country.mmdb"
          },
          "database_type": {
            "@type": "string",
            "@value": "MAXMIND_COUNTRY"
          },
          "check_interval": {
            "@type": "long",
            "@value": 1
          },
          "check_interval_unit": {
            "@type": "string",
            "@value": "MINUTES"
          }
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.1+4337e8c"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_cache",
        "version": "1"
      },
      "id": "3216f9ce-01e9-4fcc-81b2-cc3f0d852f75",
      "data": {
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "name": {
          "@type": "string",
          "@value": "geoip"
        },
        "title": {
          "@type": "string",
          "@value": "GeoIP"
        },
        "description": {
          "@type": "string",
          "@value": "GeoIP Cache"
        },
        "configuration": {
          "type": {
            "@type": "string",
            "@value": "guava_cache"
          },
          "max_size": {
            "@type": "integer",
            "@value": 1000
          },
          "expire_after_access": {
            "@type": "long",
            "@value": 1
          },
          "expire_after_access_unit": {
            "@type": "string",
            "@value": "SECONDS"
          },
          "expire_after_write": {
            "@type": "long",
            "@value": 0
          }
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.1+4337e8c"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_table",
        "version": "1"
      },
      "id": "f00b99f5-95ea-45c4-acd8-6c7b46ff2310",
      "data": {
        "default_single_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "cache_name": {
          "@type": "string",
          "@value": "3216f9ce-01e9-4fcc-81b2-cc3f0d852f75"
        },
        "name": {
          "@type": "string",
          "@value": "geoip"
        },
        "default_multi_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "default_multi_value": {
          "@type": "string",
          "@value": ""
        },
        "data_adapter_name": {
          "@type": "string",
          "@value": "475baaaa-123f-471c-96a0-b405277f6cb5"
        },
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "title": {
          "@type": "string",
          "@value": "GeoIP"
        },
        "default_single_value": {
          "@type": "string",
          "@value": ""
        },
        "description": {
          "@type": "string",
          "@value": "Geo IP Lookup"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.1+4337e8c"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline",
        "version": "1"
      },
      "id": "a1bc4b31-38e6-4227-a6b0-d14550fab0dc",
      "data": {
        "title": {
          "@type": "string",
          "@value": "GeoIP"
        },
        "description": {
          "@type": "string",
          "@value": "GeoIP"
        },
        "source": {
          "@type": "string",
          "@value": "pipeline \"GeoIP\"\nstage 0 match either\nrule \"GeoIP lookup: src-ip\"\nrule \"GeoIP lookup: dst-ip\"\nend"
        },
        "connected_streams": [
          {
            "@type": "string",
            "@value": "ec694145-91a0-4532-b6c5-777defae71e7"
          }
        ]
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.1+4337e8c"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "b4f9a033-3239-4f07-a95c-d0c3839c780e",
      "data": {
        "title": {
          "@type": "string",
          "@value": "GeoIP lookup: dst-ip"
        },
        "description": {
          "@type": "string",
          "@value": "Destination IP geo location lookup"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"GeoIP lookup: dst-ip\"\nwhen\nhas_field(\"dst-ip\")\nthen\nlet dst = lookup(\"geoip\", to_string($message.\"dst-ip\"));\nset_field(\"dst-ip-geo-location\", dst[\"coordinates\"]);\nset_field(\"dst-ip-geo-country\", dst[\"country\"].iso_code);\nset_field(\"dst-ip-geo-city\", dst[\"city\"].names.en);\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.1+4337e8c"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "e6d62d08-b7d0-40ec-b041-c8faa89ba4e2",
      "data": {
        "title": {
          "@type": "string",
          "@value": "GeoIP lookup: src-ip"
        },
        "description": {
          "@type": "string",
          "@value": "Source IP geo location lookup"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"GeoIP lookup: src-ip\"\nwhen\nhas_field(\"src-ip\")\nthen\nlet src = lookup(\"geoip\", to_string($message.\"src-ip\"));\nset_field(\"src-ip-geo-location\", src[\"coordinates\"]);\nset_field(\"src-ip-geo-country\", src[\"country\"].iso_code);\nset_field(\"src-ip-geo-city\", src[\"city\"].names.en);\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.1+4337e8c"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "stream",
        "version": "1"
      },
      "id": "ec694145-91a0-4532-b6c5-777defae71e7",
      "data": {
        "alarm_callbacks": [],
        "outputs": [],
        "remove_matches": {
          "@type": "boolean",
          "@value": true
        },
        "title": {
          "@type": "string",
          "@value": "OPNsense / filterlog"
        },
        "stream_rules": [
          {
            "type": {
              "@type": "string",
              "@value": "CONTAINS"
            },
            "field": {
              "@type": "string",
              "@value": "application_name"
            },
            "value": {
              "@type": "string",
              "@value": "filterlog"
            },
            "inverted": {
              "@type": "boolean",
              "@value": false
            },
            "description": {
              "@type": "string",
              "@value": ""
            }
          }
        ],
        "alert_conditions": [],
        "matching_type": {
          "@type": "string",
          "@value": "OR"
        },
        "disabled": {
          "@type": "boolean",
          "@value": false
        },
        "description": {
          "@type": "string",
          "@value": "OPNsense filter logs"
        },
        "default_stream": {
          "@type": "boolean",
          "@value": false
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.1+4337e8c"
        }
      ]
    }
  ]
}
